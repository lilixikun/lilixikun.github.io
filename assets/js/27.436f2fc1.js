(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{376:function(a,s,e){"use strict";e.r(s);var t=e(25),n=Object(t.a)({},(function(){var a=this,s=a.$createElement,e=a._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"sonar简单使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sonar简单使用"}},[a._v("#")]),a._v(" Sonar简单使用")]),a._v(" "),e("h2",{attrs:{id:"linux安装jdk"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux安装jdk"}},[a._v("#")]),a._v(" Linux安装jdk")]),a._v(" "),e("h2",{attrs:{id:"linux-安装-sonarqube"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#linux-安装-sonarqube"}},[a._v("#")]),a._v(" Linux 安装 sonarqube")]),a._v(" "),e("p",[a._v("去"),e("a",{attrs:{href:"https://www.sonarqube.org/downloads/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网"),e("OutboundLink")],1),a._v(" 下载安装包")]),a._v(" "),e("p",[e("strong",[a._v("执行解压")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("unzip sonarqube-8.4.0.35506\n")])])]),e("ul",[e("li",[a._v("bin 目录存放了各个环境的启动脚本")]),a._v(" "),e("li",[a._v("conf 目录存放sonarqube的配置文件")]),a._v(" "),e("li",[a._v("logs 目录存放着启动和运行时的日志文件")])]),a._v(" "),e("p",[a._v("进入对应操作系统")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("cd linux-x86-64/\n")])])]),e("p",[a._v("查看sonarqube 命名")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("./sonar.sh\n")])])]),e("p",[a._v("启动之前先使用 chown 命令将sonarqube及其子目录授权给一个非root的用户，sonarqube及其es等软件禁止 root账户启动，因此需要切换一个非root账户，授权的用户需要有bin目录及其子目录的读取和可执行的权限")]),a._v(" "),e("p",[e("strong",[a._v("添加用户")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("useradd xikun\n")])])]),e("p",[e("strong",[a._v("设置密码")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("passwd xikun\n")])])]),e("p",[e("strong",[a._v("把文件夹的授权给某一个用户")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("chown -R xikun /usr/local/src/sonarqube-8.4.0.35506\n")])])]),e("p",[e("strong",[a._v("切换用户")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("su xikun\n")])])]),e("p",[e("strong",[a._v("启动sonar")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("./sonar.sh start\n")])])]),e("p",[e("strong",[a._v("查看sonar 是否启动")])]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("ss -ntpl | grep 9000\n")])])]),e("p",[e("img",{attrs:{src:"/engineering/sonar_start.jpeg",alt:"sonar_start.jepe"}})]),a._v(" "),e("h2",{attrs:{id:"访问服务器-9000"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#访问服务器-9000"}},[a._v("#")]),a._v(" 访问服务器:9000")]),a._v(" "),e("p",[a._v("点击登陆进入")]),a._v(" "),e("p",[a._v("默认账户,密码 都是 "),e("strong",[a._v("admin")])]),a._v(" "),e("p",[a._v("安装中文插件 "),e("strong",[a._v("chinese")])]),a._v(" "),e("p",[e("img",{attrs:{src:"/engineering/sonar_chinese.png",alt:"sonar_chinese.jepe"}})]),a._v(" "),e("h2",{attrs:{id:"sonarqube-账号-token-的生成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#sonarqube-账号-token-的生成"}},[a._v("#")]),a._v(" sonarqube 账号 token 的生成")]),a._v(" "),e("p",[a._v("onarqube支持生成用户token，以便在命令行或者脚本中使用token代表账号操作sonarbue，避免造成账号密码的泄露。\n点击sonarqube首页右上角头像，进入我的账号")]),a._v(" "),e("p",[e("img",{attrs:{src:"/engineering/sonar_token.png",alt:"token.png"}})]),a._v(" "),e("p",[e("strong",[a._v("token")]),a._v("\n201e7b90ae737e356d65b6edd205ee31758d77ff")]),a._v(" "),e("h2",{attrs:{id:"检测前段代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#检测前段代码"}},[a._v("#")]),a._v(" 检测前段代码")]),a._v(" "),e("ul",[e("li",[a._v("创建一个项目如 test_01")]),a._v(" "),e("li",[a._v("生成token,生成token时会要求输入一个密钥，如果不输入的话会直接使用项目名，安全起见，输入一个随机字符串")]),a._v(" "),e("li",[a._v("选择语言，进行构建即可。因为是js,ts项目，所以需要额外下载sonar-scanner，安装完成后，直接使用下面给的命令进行检查即可")])]),a._v(" "),e("p",[a._v("下载 "),e("strong",[a._v("sonar-scanner")]),a._v(" 到本地 并配置环境变量")]),a._v(" "),e("p",[a._v("macOs 下")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("vim ~/.bash_profile\n\nexport sonar = xxxx/bin\n\nexport PATH=${sonar}:xx\n\nsource ~/.bash_profile\n")])])]),e("p",[a._v("查看 "),e("strong",[a._v("sonar-scanner")]),a._v(" 版本")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sonar-scanner  -v\n")])])]),e("h3",{attrs:{id:"测试代码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#测试代码"}},[a._v("#")]),a._v(" 测试代码")]),a._v(" "),e("p",[a._v("如现在我们现在要 检查项目A 的代码 那么在项目根目录下 新建 "),e("strong",[a._v("sonar-project.properties")]),a._v(",填入一下信息")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sonar.host.url=\n\n#----- Default source code encoding\n sonar.sourceEncoding=UTF-8\n sonar.source=.\n sonar.projectKey=test_01\n sonar.login=\n")])])]),e("p",[a._v("在项目终端执行")]),a._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[a._v("sonar-scanner\n")])])]),e("p",[e("img",{attrs:{src:"/engineering/sonar-scanner.png",alt:"sonar-scanner.png"}})]),a._v(" "),e("p",[a._v("然后就是漫长的等待")]),a._v(" "),e("p",[e("img",{attrs:{src:"/engineering/sonar_wait.png",alt:"sonar_wait.png"}})]),a._v(" "),e("p",[a._v("最后我们查看网站的代码检查报表")]),a._v(" "),e("p",[e("img",{attrs:{src:"/engineering/sonar_repo.png",alt:"sonar_repo.png"}})]),a._v(" "),e("p",[a._v("项目令牌")]),a._v(" "),e("p",[a._v("test："),e("strong",[a._v("40e778e195cd49feb2c135c215753e32f3cb657c")])])])}),[],!1,null,null,null);s.default=n.exports}}]);